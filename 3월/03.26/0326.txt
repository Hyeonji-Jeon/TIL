0326


파일 업로드

파일 업로드 문제점
- 동일한 이름의 파일 업로드 - UUID : 임의의 랜덤한 문자열
- 서버 리소스 ( 동일 폴더에 너무 많은 파일 - 속도 ) 
- 파일의 크기 - 썸네일 처리

업로드된 파일을 서비스하는 방법

- 별도 서버 - nginx, AWS S3 - WAS와 분리 - WAS 성능 유지 - 큰 서비스들
- 스프링 내부의 컨트롤러에서 처리 - 보안 처리 가능
- 설정으로 서비스 - 성능면에서는 별로지만 빠르게 적용 가능

등록
- tbl_product 테이블에 insert 하면서 새로 insert된 상품번호를 알아내야 함 32번
- 32번을 이용해서 tbl_product_img 테이블에 insert할 때 사용

조회 

- 조인

수정
- DB상에 존재하는 상품의 모든 이미지들을 알아와서 남겨둘 파일과 삭제할 파일을 구분해 주어야 함
- tbl_product_img 테이블은 해당 상품의 이미지들을 모두 삭제
- 다시 fileName를 이용해서 새로 추가
- DB 처리 작업이 끝난 후에 필요없는 파일들을 삭제

수정 

GET방식으로 상품 수정 페이지를 보게 됨

상품을 조회해서 화면에 출력 - 조회와 동일

화면의 다른 점들
- 새로운 파일 추가를 위한 <input> 필요
- 이름, 가격, 설명 등은 수정이 가능해야 함
- 현재 상품의 모든 이미지들이 보여져야 함
- 원하는 기존 이미지는 삭제해서 화면에서 사라져야 함
- 전송시에는 기존 이미지들은 그냥 문자열로, 추가된 이미지들은 MultipartFile로 처리