0317 의존성주입

스프링 레거시(legacy) 프로젝트 / 스프링 부트 (툴)

현재 6.x

경량 프레임워크 - 90's

스프링 프레임워크의 역사

가볍게 만들어서 크게 키우자 - 객체지향 - 마틴파울러 - 의존성 주입

버전 문제 - 유지보수

XML 설정 / JAVA 설정

-------------------------------------------------------

Application Context - 동네, 마을 - 빈 팩토리

Bean(빈) - 주민 - 객체

초기 - XML 설정, 2.5 버전 - Java 8 어노테이션 @Service @Controller

XML로 빈을 설정 - 나한테 소스 코드가 없음

Java나 @으로 빈을 설정 - XML 설정 대신에 사용 가능, 직접 @ 이용해서 소스 코드에 적용

*주의* - 설정 하나 할 때마다 동작을 확인할 것

----------------------------------------------------------

1. 개발 도구

2. 프로젝트 생성

3. DB 준비

@Service

@Repository

의존성 주입
: 클래스 타입 보다는 인터페이스 타입으로 주입하는 것이 더 권장된다

해당 인터페이스를 구현한 클래스가 2개 이상인 경우 어떤 객체를 주입해야 하는지 문제가 생긴다
ex) but found 2

이런 경우에는 @Primary를 이용하거나 @Qualifier를 이용한다

단, @Qualifier를 쓰려면 생성자 코드가 필요하다. (= 불편하다)

-----------------------------------------------------------

의존성 주입 방법은 여러가지 방법이 있다

*생성자 주입* 이 기본

final 쓰고 생성자 생성 - 생성자 자동 주입 (4버전 이후에는 가장 권장되는 방법)

setter / 직접 주입(필드주입) - 권장되지 않음

------------------------------------------------------------

Maria DB 드라이버 설정

DataSpirce (커넥션 풀) - HikariCP 설정

연동 확인

-------------------------------------------------------------

MyBatis 설정

라이브러리 - MyBatis / Spring - MyBatis 라이브러리.. 기타 등등

테스트

Error
- Connection refused - 아이피 / 포트 확인
- Access Denied - 계정 / 데이터베이스 이름 확인

--------------------------------------------------------------

테스트 환경 구축 - 테스트 진행

MyBatis 세팅

추가 라이브러리 - spring-jdbc, spring-tx (option)

MyBatis / MyBatis - Spring

SQL을 처리하는 Mapper 인터페이스를 작성

root-context.xml을 이용해서 MyBatis 설정 추가

상단에 xmlns같은 부분 추가

<mybais:scan> 태그를 추가

--------------------------------------------------------------

SQL Mapping Framework

2가지 종류의 설정 XML

mybatis-config.xml - MtBatis 자체에 대한 설정

mapper xml - SQL문을 적어두는 SQL

---------------------------------------------------------------

초보자 - XML 세팅 없이 사용 - Spring 설정만 이용

mapper XML 설정 - 시작 단계에서는 @Select 를 이용해서 동작을 확인 - XML로 분리

mybatis-config 설정




Java 개발 

Mapper인터페이스 정의 

SQL은 XML 정리 - <mapper namespace="org.example.sp1.mapper.TimeMapper"> 인터페이스이름과 일치

id가 인터페이스에 정의한 메서드의 이름 

resultType이 메서드의 반환 타입 


<select id="getTime" resultType="string">
String getTime();
