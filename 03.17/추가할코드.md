## HeideSQL

CREATE DATABASE springdb;

CREATE USER 'springdbuser'@'localhost' IDENTIFIED BY 'springdbuser';
CREATE USER 'springdbuser'@'%' IDENTIFIED BY 'springdbuser';

GRANT ALL PRIVILEGES ON springdb.* TO 'springdbuser'@'localhost';
GRANT ALL PRIVILEGES ON springdb.* TO 'springdbuser'@'%';

## build.gradle

    // https://mvnrepository.com/artifact/org.springframework/spring-core
    implementation 'org.springframework:spring-core:6.2.3'
    implementation 'org.springframework:spring-webmvc:6.2.3'
    implementation 'org.springframework:spring-context:6.2.3'
    implementation 'org.springframework:spring-test:6.2.3'

    //for myBatis
    implementation 'org.springframework:spring-jdbc:6.2.3'
    implementation 'org.springframework:spring-tx:6.2.3'

    // https://mvnrepository.com/artifact/org.projectlombok/lombok
    compileOnly 'org.projectlombok:lombok:1.18.30'
    annotationProcessor 'org.projectlombok:lombok:1.18.30'
    testCompileOnly 'org.projectlombok:lombok:1.18.30'
    testAnnotationProcessor 'org.projectlombok:lombok:1.18.30'

    // https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-core
    implementation 'org.apache.logging.log4j:log4j-core:2.17.1'
    implementation 'org.apache.logging.log4j:log4j-api:2.17.1'
    implementation 'org.apache.logging.log4j:log4j-slf4j-impl:2.17.1'

    // https://mvnrepository.com/artifact/org.mariadb.jdbc/mariadb-java-client
    implementation 'org.mariadb.jdbc:mariadb-java-client:3.5.2'

    // https://mvnrepository.com/artifact/com.zaxxer/HikariCP
    implementation 'com.zaxxer:HikariCP:5.1.0'

    // https://mvnrepository.com/artifact/org.mybatis/mybatis
    implementation 'org.mybatis:mybatis:3.5.19'
    implementation 'org.mybatis:mybatis-spring:3.0.4'

## TimeMapper.java

package org.example.sp1.mapper;

import org.apache.ibatis.annotations.Select;

public interface TimeMapper {

    //마지막에 ;없음 주의
    //@Select("select now()")
    String getTime();
}

## TimeMapper.xml

<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.example.sp1.mapper.TimeMapper">
    <select id="getTime" resultType="string">
        select now()
    </select>
</mapper>

## log4j2

 <!-- Logger 설정 -->
    <Loggers>
        <Logger name="com.zaxxer" level="DEBUG" additivity="false">
            <AppenderRef ref="console"/>
        </Logger>
        <Logger name="org.springframework" level="INFO" additivity="false">
            <AppenderRef ref="console"/>
        </Logger>
        <Logger name="org.example.sp1" level="DEBUG" additivity="false">
            <AppenderRef ref="console"/>
        </Logger>

        <Root level="INFO">
            <AppenderRef ref="console"/>
        </Root>
    </Loggers>

## DBTests

package org.example.db;

import com.zaxxer.hikari.HikariDataSource;
import lombok.extern.log4j.Log4j2;
import org.example.sp1.mapper.TimeMapper;
import org.example.sp1.service.HelloService;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit.jupiter.SpringExtension;

import java.sql.Connection;
import java.sql.SQLException;

@ExtendWith(SpringExtension.class)
@Log4j2
@ContextConfiguration("file:src/main/webapp/WEB-INF/root-context.xml")
public class DBTests {

    @Autowired
    HikariDataSource ds;

    @Autowired(required = false)
    TimeMapper timeMapper;

    @Test
    public void testTime() throws SQLException {
        log.info(timeMapper.getTime());
    }

    @Test
    public void testDB() {
        log.info("testDB");
        log.info(ds);
    }

    @Test
    public void testDB2() throws Exception {

        Connection conn = ds.getConnection();
        log.info(conn);
        conn.close();
    }

}














